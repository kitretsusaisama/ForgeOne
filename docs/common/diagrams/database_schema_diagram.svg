<svg xmlns="http://www.w3.org/2000/svg" width="1200" height="1600" viewBox="0 0 1200 1600">
  <style>
    .database { fill: #B0C4DE; stroke: #333; stroke-width: 2; }
    .table { fill: #F0F8FF; stroke: #333; stroke-width: 2; }
    .shard { fill: #E6E6FA; stroke: #333; stroke-width: 2; }
    .field { fill: #FFFFFF; stroke: #333; stroke-width: 1; }
    .pk { fill: #FFD700; stroke: #333; stroke-width: 1; }
    .fk { fill: #98FB98; stroke: #333; stroke-width: 1; }
    .text { font-family: Arial; font-size: 14px; }
    .title { font-family: Arial; font-size: 24px; font-weight: bold; }
    .subtitle { font-family: Arial; font-size: 18px; font-weight: bold; }
    .table-title { font-family: Arial; font-size: 16px; font-weight: bold; }
    .field-text { font-family: Arial; font-size: 12px; }
    .line { stroke: #333; stroke-width: 2; }
    .dashed-line { stroke: #333; stroke-width: 2; stroke-dasharray: 5,5; }
    .arrow { fill: #333; }
  </style>

  <!-- Title -->
  <text x="600" y="40" text-anchor="middle" class="title">ForgeOne Database Schema</text>

  <!-- System Database -->
  <rect x="100" y="80" width="1000" height="300" rx="10" ry="10" class="database" />
  <text x="600" y="110" text-anchor="middle" class="subtitle">System Database (system.redb)</text>

  <!-- System Tables -->
  <rect x="150" y="130" width="250" height="230" rx="5" ry="5" class="table" />
  <text x="275" y="150" text-anchor="middle" class="table-title">Configuration</text>
  
  <rect x="160" y="160" width="230" height="25" rx="2" ry="2" class="pk" />
  <text x="170" y="178" class="field-text">key: String (PK)</text>
  
  <rect x="160" y="190" width="230" height="25" rx="2" ry="2" class="field" />
  <text x="170" y="208" class="field-text">value: JSON</text>
  
  <rect x="160" y="220" width="230" height="25" rx="2" ry="2" class="field" />
  <text x="170" y="238" class="field-text">version: u64</text>
  
  <rect x="160" y="250" width="230" height="25" rx="2" ry="2" class="field" />
  <text x="170" y="268" class="field-text">last_modified: Timestamp</text>
  
  <rect x="160" y="280" width="230" height="25" rx="2" ry="2" class="field" />
  <text x="170" y="298" class="field-text">encrypted: bool</text>
  
  <rect x="160" y="310" width="230" height="25" rx="2" ry="2" class="field" />
  <text x="170" y="328" class="field-text">checksum: String</text>

  <rect x="450" y="130" width="250" height="230" rx="5" ry="5" class="table" />
  <text x="575" y="150" text-anchor="middle" class="table-title">Identity</text>
  
  <rect x="460" y="160" width="230" height="25" rx="2" ry="2" class="pk" />
  <text x="470" y="178" class="field-text">id: UUID (PK)</text>
  
  <rect x="460" y="190" width="230" height="25" rx="2" ry="2" class="field" />
  <text x="470" y="208" class="field-text">name: String</text>
  
  <rect x="460" y="220" width="230" height="25" rx="2" ry="2" class="field" />
  <text x="470" y="238" class="field-text">type: IdentityType</text>
  
  <rect x="460" y="250" width="230" height="25" rx="2" ry="2" class="field" />
  <text x="470" y="268" class="field-text">public_key: Bytes</text>
  
  <rect x="460" y="280" width="230" height="25" rx="2" ry="2" class="field" />
  <text x="470" y="298" class="field-text">metadata: JSON</text>
  
  <rect x="460" y="310" width="230" height="25" rx="2" ry="2" class="field" />
  <text x="470" y="328" class="field-text">created_at: Timestamp</text>

  <rect x="750" y="130" width="250" height="230" rx="5" ry="5" class="table" />
  <text x="875" y="150" text-anchor="middle" class="table-title">Policy</text>
  
  <rect x="760" y="160" width="230" height="25" rx="2" ry="2" class="pk" />
  <text x="770" y="178" class="field-text">id: UUID (PK)</text>
  
  <rect x="760" y="190" width="230" height="25" rx="2" ry="2" class="field" />
  <text x="770" y="208" class="field-text">name: String</text>
  
  <rect x="760" y="220" width="230" height="25" rx="2" ry="2" class="field" />
  <text x="770" y="238" class="field-text">rules: JSON</text>
  
  <rect x="760" y="250" width="230" height="25" rx="2" ry="2" class="field" />
  <text x="770" y="268" class="field-text">version: u64</text>
  
  <rect x="760" y="280" width="230" height="25" rx="2" ry="2" class="field" />
  <text x="770" y="298" class="field-text">active: bool</text>
  
  <rect x="760" y="310" width="230" height="25" rx="2" ry="2" class="field" />
  <text x="770" y="328" class="field-text">last_modified: Timestamp</text>

  <!-- Logs Database -->
  <rect x="100" y="400" width="1000" height="300" rx="10" ry="10" class="database" />
  <text x="600" y="430" text-anchor="middle" class="subtitle">Logs Database (logs_shard_*.redb)</text>

  <!-- Logs Shards -->
  <rect x="150" y="450" width="900" height="60" rx="5" ry="5" class="shard" />
  <text x="600" y="485" text-anchor="middle" class="text">Sharded by Time (4 shards: logs_shard_0.redb through logs_shard_3.redb)</text>

  <!-- Logs Tables -->
  <rect x="150" y="530" width="250" height="150" rx="5" ry="5" class="table" />
  <text x="275" y="550" text-anchor="middle" class="table-title">AuditLog</text>
  
  <rect x="160" y="560" width="230" height="25" rx="2" ry="2" class="pk" />
  <text x="170" y="578" class="field-text">id: UUID (PK)</text>
  
  <rect x="160" y="590" width="230" height="25" rx="2" ry="2" class="field" />
  <text x="170" y="608" class="field-text">timestamp: Timestamp</text>
  
  <rect x="160" y="620" width="230" height="25" rx="2" ry="2" class="fk" />
  <text x="170" y="638" class="field-text">identity_id: UUID (FK)</text>
  
  <rect x="160" y="650" width="230" height="25" rx="2" ry="2" class="field" />
  <text x="170" y="668" class="field-text">action: String</text>

  <rect x="450" y="530" width="250" height="150" rx="5" ry="5" class="table" />
  <text x="575" y="550" text-anchor="middle" class="table-title">SystemLog</text>
  
  <rect x="460" y="560" width="230" height="25" rx="2" ry="2" class="pk" />
  <text x="470" y="578" class="field-text">id: UUID (PK)</text>
  
  <rect x="460" y="590" width="230" height="25" rx="2" ry="2" class="field" />
  <text x="470" y="608" class="field-text">timestamp: Timestamp</text>
  
  <rect x="460" y="620" width="230" height="25" rx="2" ry="2" class="field" />
  <text x="470" y="638" class="field-text">level: LogLevel</text>
  
  <rect x="460" y="650" width="230" height="25" rx="2" ry="2" class="field" />
  <text x="470" y="668" class="field-text">message: String</text>

  <rect x="750" y="530" width="250" height="150" rx="5" ry="5" class="table" />
  <text x="875" y="550" text-anchor="middle" class="table-title">SecurityLog</text>
  
  <rect x="760" y="560" width="230" height="25" rx="2" ry="2" class="pk" />
  <text x="770" y="578" class="field-text">id: UUID (PK)</text>
  
  <rect x="760" y="590" width="230" height="25" rx="2" ry="2" class="field" />
  <text x="770" y="608" class="field-text">timestamp: Timestamp</text>
  
  <rect x="760" y="620" width="230" height="25" rx="2" ry="2" class="fk" />
  <text x="770" y="638" class="field-text">identity_id: UUID (FK)</text>
  
  <rect x="760" y="650" width="230" height="25" rx="2" ry="2" class="field" />
  <text x="770" y="668" class="field-text">event_type: SecurityEventType</text>

  <!-- Blobs Database -->
  <rect x="100" y="720" width="1000" height="300" rx="10" ry="10" class="database" />
  <text x="600" y="750" text-anchor="middle" class="subtitle">Blobs Database (blobs_shard_*.redb)</text>

  <!-- Blobs Shards -->
  <rect x="150" y="770" width="900" height="60" rx="5" ry="5" class="shard" />
  <text x="600" y="805" text-anchor="middle" class="text">Sharded by Content Hash (4 shards: blobs_shard_0.redb through blobs_shard_3.redb)</text>

  <!-- Blobs Tables -->
  <rect x="150" y="850" width="250" height="150" rx="5" ry="5" class="table" />
  <text x="275" y="870" text-anchor="middle" class="table-title">BlobMetadata</text>
  
  <rect x="160" y="880" width="230" height="25" rx="2" ry="2" class="pk" />
  <text x="170" y="898" class="field-text">id: UUID (PK)</text>
  
  <rect x="160" y="910" width="230" height="25" rx="2" ry="2" class="field" />
  <text x="170" y="928" class="field-text">name: String</text>
  
  <rect x="160" y="940" width="230" height="25" rx="2" ry="2" class="field" />
  <text x="170" y="958" class="field-text">content_type: String</text>
  
  <rect x="160" y="970" width="230" height="25" rx="2" ry="2" class="field" />
  <text x="170" y="988" class="field-text">created_at: Timestamp</text>

  <rect x="450" y="850" width="250" height="150" rx="5" ry="5" class="table" />
  <text x="575" y="870" text-anchor="middle" class="table-title">BlobContent</text>
  
  <rect x="460" y="880" width="230" height="25" rx="2" ry="2" class="pk" />
  <text x="470" y="898" class="field-text">id: UUID (PK)</text>
  
  <rect x="460" y="910" width="230" height="25" rx="2" ry="2" class="fk" />
  <text x="470" y="928" class="field-text">metadata_id: UUID (FK)</text>
  
  <rect x="460" y="940" width="230" height="25" rx="2" ry="2" class="field" />
  <text x="470" y="958" class="field-text">data: Bytes</text>
  
  <rect x="460" y="970" width="230" height="25" rx="2" ry="2" class="field" />
  <text x="470" y="988" class="field-text">checksum: String</text>

  <rect x="750" y="850" width="250" height="150" rx="5" ry="5" class="table" />
  <text x="875" y="870" text-anchor="middle" class="table-title">BlobAccess</text>
  
  <rect x="760" y="880" width="230" height="25" rx="2" ry="2" class="pk" />
  <text x="770" y="898" class="field-text">id: UUID (PK)</text>
  
  <rect x="760" y="910" width="230" height="25" rx="2" ry="2" class="fk" />
  <text x="770" y="928" class="field-text">blob_id: UUID (FK)</text>
  
  <rect x="760" y="940" width="230" height="25" rx="2" ry="2" class="fk" />
  <text x="770" y="958" class="field-text">identity_id: UUID (FK)</text>
  
  <rect x="760" y="970" width="230" height="25" rx="2" ry="2" class="field" />
  <text x="770" y="988" class="field-text">access_type: AccessType</text>

  <!-- Events Database -->
  <rect x="100" y="1040" width="1000" height="300" rx="10" ry="10" class="database" />
  <text x="600" y="1070" text-anchor="middle" class="subtitle">Events Database (events_shard_*.redb)</text>

  <!-- Events Shards -->
  <rect x="150" y="1090" width="900" height="60" rx="5" ry="5" class="shard" />
  <text x="600" y="1125" text-anchor="middle" class="text">Sharded by Event Type (4 shards: events_shard_0.redb through events_shard_3.redb)</text>

  <!-- Events Tables -->
  <rect x="150" y="1170" width="250" height="150" rx="5" ry="5" class="table" />
  <text x="275" y="1190" text-anchor="middle" class="table-title">EventStream</text>
  
  <rect x="160" y="1200" width="230" height="25" rx="2" ry="2" class="pk" />
  <text x="170" y="1218" class="field-text">id: UUID (PK)</text>
  
  <rect x="160" y="1230" width="230" height="25" rx="2" ry="2" class="field" />
  <text x="170" y="1248" class="field-text">name: String</text>
  
  <rect x="160" y="1260" width="230" height="25" rx="2" ry="2" class="field" />
  <text x="170" y="1278" class="field-text">description: String</text>
  
  <rect x="160" y="1290" width="230" height="25" rx="2" ry="2" class="field" />
  <text x="170" y="1308" class="field-text">created_at: Timestamp</text>

  <rect x="450" y="1170" width="250" height="150" rx="5" ry="5" class="table" />
  <text x="575" y="1190" text-anchor="middle" class="table-title">Event</text>
  
  <rect x="460" y="1200" width="230" height="25" rx="2" ry="2" class="pk" />
  <text x="470" y="1218" class="field-text">id: UUID (PK)</text>
  
  <rect x="460" y="1230" width="230" height="25" rx="2" ry="2" class="fk" />
  <text x="470" y="1248" class="field-text">stream_id: UUID (FK)</text>
  
  <rect x="460" y="1260" width="230" height="25" rx="2" ry="2" class="field" />
  <text x="470" y="1278" class="field-text">timestamp: Timestamp</text>
  
  <rect x="460" y="1290" width="230" height="25" rx="2" ry="2" class="field" />
  <text x="470" y="1308" class="field-text">payload: JSON</text>

  <rect x="750" y="1170" width="250" height="150" rx="5" ry="5" class="table" />
  <text x="875" y="1190" text-anchor="middle" class="table-title">Subscription</text>
  
  <rect x="760" y="1200" width="230" height="25" rx="2" ry="2" class="pk" />
  <text x="770" y="1218" class="field-text">id: UUID (PK)</text>
  
  <rect x="760" y="1230" width="230" height="25" rx="2" ry="2" class="fk" />
  <text x="770" y="1248" class="field-text">stream_id: UUID (FK)</text>
  
  <rect x="760" y="1260" width="230" height="25" rx="2" ry="2" class="fk" />
  <text x="770" y="1278" class="field-text">identity_id: UUID (FK)</text>
  
  <rect x="760" y="1290" width="230" height="25" rx="2" ry="2" class="field" />
  <text x="770" y="1308" class="field-text">filter: JSON</text>

  <!-- Relationships -->
  <line x1="275" y1="380" x2="575" y2="530" class="dashed-line" />
  <line x1="575" y1="380" x2="275" y2="530" class="dashed-line" />
  <line x1="575" y1="380" x2="875" y2="530" class="dashed-line" />
  <line x1="275" y1="1000" x2="575" y2="850" class="dashed-line" />
  <line x1="575" y1="1000" x2="875" y2="850" class="dashed-line" />
  <line x1="275" y1="1320" x2="575" y2="1170" class="dashed-line" />
  <line x1="575" y1="1320" x2="875" y2="1170" class="dashed-line" />

  <!-- Legend -->
  <rect x="100" y="1360" width="1000" height="120" rx="10" ry="10" stroke="#333" stroke-width="2" fill="#F8F8F8" />
  <text x="600" y="1380" text-anchor="middle" class="subtitle">Legend</text>
  
  <rect x="150" y="1400" width="30" height="30" class="database" />
  <text x="190" y="1420" class="text">Database</text>
  
  <rect x="250" y="1400" width="30" height="30" class="table" />
  <text x="290" y="1420" class="text">Table</text>
  
  <rect x="350" y="1400" width="30" height="30" class="shard" />
  <text x="390" y="1420" class="text">Shard</text>
  
  <rect x="450" y="1400" width="30" height="30" class="pk" />
  <text x="490" y="1420" class="text">Primary Key</text>
  
  <rect x="550" y="1400" width="30" height="30" class="fk" />
  <text x="590" y="1420" class="text">Foreign Key</text>
  
  <rect x="650" y="1400" width="30" height="30" class="field" />
  <text x="690" y="1420" class="text">Field</text>
  
  <line x1="750" y1="1415" x2="800" y2="1415" class="line" />
  <text x="840" y="1420" class="text">Relationship</text>
  
  <line x1="900" y1="1415" x2="950" y2="1415" class="dashed-line" />
  <text x="990" y="1420" class="text">Reference</text>

  <!-- Footer -->
  <text x="600" y="1500" text-anchor="middle" class="text">ForgeOne Common Module - Database Schema</text>
  <text x="600" y="1520" text-anchor="middle" class="text">Generated from db/schema.rs</text>
</svg>