<svg xmlns="http://www.w3.org/2000/svg" width="1200" height="1200" viewBox="0 0 1200 1200">
  <style>
    .module { fill: #90EE90; stroke: #333; stroke-width: 2; }
    .component { fill: #ADD8E6; stroke: #333; stroke-width: 2; }
    .external { fill: #FFD700; stroke: #333; stroke-width: 2; }
    .common { fill: #FF9999; stroke: #333; stroke-width: 2; }
    .text { font-family: Arial; font-size: 14px; }
    .title { font-family: Arial; font-size: 24px; font-weight: bold; }
    .subtitle { font-family: Arial; font-size: 18px; font-weight: bold; }
    .description { font-family: Arial; font-size: 12px; fill: #555; }
    .line { stroke: #333; stroke-width: 2; }
    .dashed { stroke: #333; stroke-width: 2; stroke-dasharray: 5,5; }
    .arrow { stroke: #333; stroke-width: 2; marker-end: url(#arrowhead); }
    .bidirectional { stroke: #333; stroke-width: 2; marker-end: url(#arrowhead); marker-start: url(#arrowhead); }
    .pattern { fill: #E6E6FA; stroke: #333; stroke-width: 1; }
  </style>

  <!-- Arrow marker definition -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#333" />
    </marker>
  </defs>

  <!-- Title -->
  <text x="600" y="50" text-anchor="middle" class="title">ForgeOne Common Module Integration Patterns</text>
  <text x="600" y="80" text-anchor="middle" class="subtitle">System-wide Integration Architecture</text>

  <!-- Common Module (Center) -->
  <circle cx="600" cy="400" r="150" class="common" />
  <text x="600" y="390" text-anchor="middle" class="subtitle">Common Module</text>
  <text x="600" y="415" text-anchor="middle" class="text">Core Services &amp; Utilities</text>
  
  <!-- Common Module Components -->
  <rect x="550" y="350" width="100" height="30" rx="5" class="component" />
  <text x="600" y="370" text-anchor="middle" class="text" style="font-size: 12px;">Config</text>
  
  <rect x="550" y="385" width="100" height="30" rx="5" class="component" />
  <text x="600" y="405" text-anchor="middle" class="text" style="font-size: 12px;">Identity</text>
  
  <rect x="550" y="420" width="100" height="30" rx="5" class="component" />
  <text x="600" y="440" text-anchor="middle" class="text" style="font-size: 12px;">Crypto</text>

  <!-- External Systems -->
  <!-- Runtime -->
  <rect x="600" y="100" width="200" height="100" rx="10" class="external" />
  <text x="700" y="140" text-anchor="middle" class="subtitle">Runtime</text>
  <text x="700" y="160" text-anchor="middle" class="text">Container Execution</text>
  <line x1="700" y1="200" x2="650" y2="250" class="bidirectional" />
  
  <!-- Microkernel -->
  <rect x="900" y="250" width="200" height="100" rx="10" class="external" />
  <text x="1000" y="290" text-anchor="middle" class="subtitle">Microkernel</text>
  <text x="1000" y="310" text-anchor="middle" class="text">Core System Services</text>
  <line x1="900" y1="300" x2="750" y2="350" class="bidirectional" />
  
  <!-- Plugin Manager -->
  <rect x="900" y="450" width="200" height="100" rx="10" class="external" />
  <text x="1000" y="490" text-anchor="middle" class="subtitle">Plugin Manager</text>
  <text x="1000" y="510" text-anchor="middle" class="text">Extension System</text>
  <line x1="900" y1="500" x2="750" y2="450" class="bidirectional" />
  
  <!-- Database -->
  <rect x="600" y="700" width="200" height="100" rx="10" class="external" />
  <text x="700" y="740" text-anchor="middle" class="subtitle">Database</text>
  <text x="700" y="760" text-anchor="middle" class="text">Persistent Storage</text>
  <line x1="700" y1="700" x2="650" y2="550" class="bidirectional" />
  
  <!-- API Gateway -->
  <rect x="100" y="250" width="200" height="100" rx="10" class="external" />
  <text x="200" y="290" text-anchor="middle" class="subtitle">API Gateway</text>
  <text x="200" y="310" text-anchor="middle" class="text">External Interface</text>
  <line x1="300" y1="300" x2="450" y2="350" class="bidirectional" />
  
  <!-- Security Services -->
  <rect x="100" y="450" width="200" height="100" rx="10" class="external" />
  <text x="200" y="490" text-anchor="middle" class="subtitle">Security Services</text>
  <text x="200" y="510" text-anchor="middle" class="text">Authentication &amp; Authorization</text>
  <line x1="300" y1="500" x2="450" y2="450" class="bidirectional" />

  <!-- Integration Patterns -->
  <!-- Observer Pattern -->
  <ellipse cx="450" y="250" rx="100" ry="40" class="pattern" />
  <text x="450" y="255" text-anchor="middle" class="text">Observer Pattern</text>
  
  <!-- Dependency Injection -->
  <ellipse cx="750" y="250" rx="100" ry="40" class="pattern" />
  <text x="750" y="255" text-anchor="middle" class="text">Dependency Injection</text>
  
  <!-- Repository Pattern -->
  <ellipse cx="650" y="600" rx="100" ry="40" class="pattern" />
  <text x="650" y="605" text-anchor="middle" class="text">Repository Pattern</text>
  
  <!-- Adapter Pattern -->
  <ellipse cx="450" y="550" rx="100" ry="40" class="pattern" />
  <text x="450" y="555" text-anchor="middle" class="text">Adapter Pattern</text>
  
  <!-- Factory Pattern -->
  <ellipse cx="750" y="550" rx="100" ry="40" class="pattern" />
  <text x="750" y="555" text-anchor="middle" class="text">Factory Pattern</text>

  <!-- Integration Details -->
  <rect x="100" y="850" width="1000" height="250" rx="10" stroke="#333" stroke-width="2" fill="#F8F8F8" />
  <text x="600" y="880" text-anchor="middle" class="subtitle">Integration Details</text>
  
  <!-- Integration Details Content -->
  <rect x="120" y="900" width="300" height="80" rx="5" class="pattern" />
  <text x="270" y="920" text-anchor="middle" class="text">Observer Pattern</text>
  <text x="270" y="940" text-anchor="middle" class="description">Used for event propagation via observer.rs</text>
  <text x="270" y="960" text-anchor="middle" class="description">Components subscribe to events</text>
  
  <rect x="450" y="900" width="300" height="80" rx="5" class="pattern" />
  <text x="600" y="920" text-anchor="middle" class="text">Dependency Injection</text>
  <text x="600" y="940" text-anchor="middle" class="description">Used for service composition</text>
  <text x="600" y="960" text-anchor="middle" class="description">Decouples component dependencies</text>
  
  <rect x="780" y="900" width="300" height="80" rx="5" class="pattern" />
  <text x="930" y="920" text-anchor="middle" class="text">Repository Pattern</text>
  <text x="930" y="940" text-anchor="middle" class="description">Used for data access via db.rs</text>
  <text x="930" y="960" text-anchor="middle" class="description">Abstracts storage implementation</text>
  
  <rect x="120" y="1000" width="300" height="80" rx="5" class="pattern" />
  <text x="270" y="1020" text-anchor="middle" class="text">Adapter Pattern</text>
  <text x="270" y="1040" text-anchor="middle" class="description">Used for external system integration</text>
  <text x="270" y="1060" text-anchor="middle" class="description">Converts between incompatible interfaces</text>
  
  <rect x="450" y="1000" width="300" height="80" rx="5" class="pattern" />
  <text x="600" y="1020" text-anchor="middle" class="text">Factory Pattern</text>
  <text x="600" y="1040" text-anchor="middle" class="description">Used for object creation</text>
  <text x="600" y="1060" text-anchor="middle" class="description">Encapsulates instantiation logic</text>
  
  <rect x="780" y="1000" width="300" height="80" rx="5" class="pattern" />
  <text x="930" y="1020" text-anchor="middle" class="text">Service Locator</text>
  <text x="930" y="1040" text-anchor="middle" class="description">Used for service discovery</text>
  <text x="930" y="1060" text-anchor="middle" class="description">Centralized access to services</text>

  <!-- Legend -->
  <rect x="100" y="1120" width="1000" height="60" rx="10" stroke="#333" stroke-width="2" fill="#F8F8F8" />
  <text x="600" y="1145" text-anchor="middle" class="subtitle">Legend</text>
  
  <rect x="150" y="1145" width="20" height="20" class="common" />
  <text x="180" y="1160" class="text" style="font-size: 12px;">Common Module</text>
  
  <rect x="300" y="1145" width="20" height="20" class="external" />
  <text x="330" y="1160" class="text" style="font-size: 12px;">External System</text>
  
  <rect x="450" y="1145" width="20" height="20" class="component" />
  <text x="480" y="1160" class="text" style="font-size: 12px;">Component</text>
  
  <ellipse cx="600" cy="1155" rx="30" ry="15" class="pattern" />
  <text x="650" y="1160" class="text" style="font-size: 12px;">Integration Pattern</text>
  
  <line x1="700" y1="1155" x2="750" y2="1155" class="bidirectional" />
  <text x="800" y="1160" class="text" style="font-size: 12px;">Bidirectional Integration</text>
</svg>